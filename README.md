в url dl=0 меняем на dl=1

добавляем chardet версии 5.2.0 в файл requirements.txt
определяем оригинальную кодировку и перезаписываем файл

почти все столбцы типа string
root
 |-- house_id: integer (nullable = true)
 |-- latitude: double (nullable = true)
 |-- longitude: double (nullable = true)
 |-- maintenance_year: string (nullable = true)
 |-- square: string (nullable = true)
 |-- population: string (nullable = true)
 |-- region: string (nullable = true)
 |-- locality_name: string (nullable = true)
 |-- address: string (nullable = true)
 |-- full_address: string (nullable = true)
 |-- communal_service_id: string (nullable = true)
 |-- description: string (nullable = true)

df.select('maintenance_year').distinct().orderBy(desc('maintenance_year')).show()

maintenance_year
—
ё967
январь 1973г
поэтапно: 1 подъ
после 1917
план 2015
ноябрь 2013
ноябрь 2006
до1945
до1917
до 1992
до 1990
до 1973
до 1957
до 1955
до 1950
до 1946
до 1945г.
до 1945 года
до 1945 г.

df.select('square').distinct().orderBy(desc('square')).show()

+----------+
|population|
+----------+
|         —|
|       999|
|       998|
|       997|
|       996|
|       995|
|       994|
|       993|
|       992|
|       991|
|       990|
|        99|
|       989|
|       988|
|       987|
|       986|
|       985|
|       984|
|       983|
|       982|
+----------+

+-------------------+
|communal_service_id|
+-------------------+
|             9999.0|
|             9998.0|
|             9997.0|
|             9996.0|
|             9995.0|
|             9994.0|
|             9993.0|
|             9992.0|
|             9991.0|
|             9990.0|
|              999.0|
|             9989.0|
|             9988.0|
|             9987.0|
|             9986.0|
|             9985.0|
|             9984.0|
|             9983.0|
|             9982.0|
|             9981.0|
+-------------------+

df.select('maintenance_year').orderBy(desc('maintenance_year')).show()
+----------------+
|maintenance_year|
+----------------+
|            7956|
|            4963|
|            4960|
|            2975|
|            2472|
|            2340|
|            2209|
|            2109|
|            2088|
|            2018|
|            2017|
|            2017|
|            2017|
|            2017|
|            2017|
|            2016|
|            2016|
|            2014|
|            2014|
|            2014|
+----------------+

Количество строк после очистки: 439762


CREATE DATABASE russian_houses;

CREATE TABLE russian_houses.houses (
house_id UInt32,
latitude Float64,
longitude Float64,
maintenance_year UInt32,
square Float32,
population UInt32,
region String,
locality_name String,
address String,
full_address String,
communal_service_id UInt32,
description String
) ENGINE = MergeTree()
ORDER BY (house_id);

CREATE TABLE russian_houses.med_avg_years (
med_year UInt16,
avg_year UInt16
) ENGINE = MergeTree()
ORDER BY (med_year, avg_year);

CREATE TABLE russian_houses.top10_regions (
region String,
num_of_houses UInt16
) ENGINE = MergeTree()
ORDER BY (region);

CREATE TABLE russian_houses.top10_cities (
locality_name String,
num_of_houses UInt16
) ENGINE = MergeTree()
ORDER BY (locality_name);

CREATE TABLE russian_houses.max_min_square_by_region (
region String,
max_square Float32,
min_square Float32
) ENGINE = MergeTree()
ORDER BY (region);

CREATE TABLE russian_houses.houses_by_decade (
decade UInt16,
num_of_houses UInt16
) ENGINE = MergeTree()
ORDER BY (decade);

select * from russian_houses.houses_by_decade;

129907	51.307929	37.915202	2013	7058900	90	Белгородская область	Старый Оскол	мкр. Дубрава квартал 1, д. 18	обл. Белгородская, г. Старый Оскол, мкр. Дубрава квартал 1, д. 18	7322	Жилой дом в Старом Осколе, по адресу мкр. Дубрава квартал 1, д. 18, 11.09.2013г. года постройки, под управлением ТСЖ «Дубрава».
129908	51.307929	37.915202	2014	6966720	10	Белгородская область	Старый Оскол	мкр. Дубрава квартал 1, д. 19	обл. Белгородская, г. Старый Оскол, мкр. Дубрава квартал 1, д. 19	7322	Жилой дом в Старом Осколе, по адресу мкр. Дубрава квартал 1, д. 19, 24.07.2014г. года постройки, под управлением ТСЖ «Дубрава».
439756	54.997558999999995	73.221499	1966	3652010	275	Омская область	Омск	ул. Солнечная 2-я, д. 28, к. А	Омская область, г. Омск, ул. Солнечная 2-я, д. 28, к. А	23187	Жилой дом в Омске, по адресу ул. Солнечная 2-я, д. 28, к. А, 1966 года постройки, под управлением УК «УК Левобережье».
563093	56.826813	60.558721	2006	1879860	351	Свердловская область	Екатеринбург	ул. Токарей, д. 68	Свердловская область, г. Екатеринбург, ул. Токарей, д. 68	31439	Жилой дом в Екатеринбурге, по адресу ул. Токарей, д. 68, 2006-2012 года постройки, под управлением ТСЖ «Токарей68».
68482	60.94088299999999	76.560573	1982	646910	267	ХМАО	Нижневартовск	пр-кт. Победы, д. 18	Ханты-Мансийский Автономный округ - Югра, г. Нижневартовск, пр-кт. Победы, д. 18	4365	Жилой дом в Нижневартовске, по адресу пр-кт. Победы, д. 18, 1982 года постройки, под управлением УК «УК №1».
301455	56.203192	95.46790899999999	1995	452520	150	Красноярский край	поселок Филимоново	с. Филимоново, ул. Профсоюзная, д. 3	Красноярский край, р-н. Канский, с. Филимоново, ул. Профсоюзная, д. 3	16116	Жилой дом в , по адресу с. Филимоново, ул. Профсоюзная, д. 3, 1995 года постройки, под управлением УК «Фжк».
301442	56.207283	95.459294	1991	448666	150	Красноярский край	поселок Филимоново	с. Филимоново, ул. Западная, д. 11	Красноярский край, р-н. Канский, с. Филимоново, ул. Западная, д. 11	16116	Жилой дом в , по адресу с. Филимоново, ул. Западная, д. 11, 1991 года постройки, под управлением УК «Фжк».
301447	56.205636	95.461998	1986	441713	149	Красноярский край	поселок Филимоново	с. Филимоново, ул. Луговая, д. 7	Красноярский край, р-н. Канский, с. Филимоново, ул. Луговая, д. 7	16116	Жилой дом в , по адресу с. Филимоново, ул. Луговая, д. 7, 1986 года постройки, под управлением УК «Фжк».
301457	56.201640000000005	95.467199	1983	441350	169	Красноярский край	поселок Филимоново	с. Филимоново, ул. Трактовая, д. 3	Красноярский край, р-н. Канский, с. Филимоново, ул. Трактовая, д. 3	16116	Жилой дом в , по адресу с. Филимоново, ул. Трактовая, д. 3, 1983 года постройки, под управлением УК «Фжк».
109584	52.460423999999996	130.85534199999998	1985	429720	207	Амурская область	поселок Февральск	пгт. Февральск, ул. Саянская, д. 4 А	Амурская область, р-н. Селемджинский, пгт. Февральск, ул. Саянская, д. 4 А	6461	Жилой дом в , по адресу пгт. Февральск, ул. Саянская, д. 4 А, 1985 года постройки, под управлением УК «Фкс».
351465	55.757926	37.563817	1987	383408	190	Москва	Москва	пер. Трехгорный Б., д. 2	Москва, пер. Трехгорный Б., д. 2	18946	Жилой дом в Москве, по адресу пер. Трехгорный Б., д. 2, 1987 года постройки, под управлением УК «УК Пресненского района».
260554	58.645948	49.618777	1966	313165.6	176	Кировская область	Киров	ул. Свердлова, д. 8, к. а	Кировская область, г. Киров, ул. Свердлова, д. 8, к. а	13317	Жилой дом в Кирове, по адресу ул. Свердлова, д. 8, к. а, 1966 года постройки, под управлением УК «УК Октябрьского района г.Кирова».
301445	56.204519	95.462609	1975	270929	99	Красноярский край	поселок Филимоново	с. Филимоново, ул. Луговая, д. 4	Красноярский край, р-н. Канский, с. Филимоново, ул. Луговая, д. 4	16116	Жилой дом в , по адресу с. Филимоново, ул. Луговая, д. 4, 1975 года постройки, под управлением УК «Фжк».
520689	53.502293	49.425469	2004	259491	100	Самарская область	Тольятти	ул. Баныкина, д. 16В	Самарская область, г. Тольятти, ул. Баныкина, д. 16В	27927	Жилой дом в Тольятти, по адресу ул. Баныкина, д. 16В, 2004 года постройки, под управлением ТСЖ «Заря».
301444	56.204494	95.46135100000001	1971	212432	74	Красноярский край	поселок Филимоново	с. Филимоново, ул. Луговая, д. 2	Красноярский край, р-н. Канский, с. Филимоново, ул. Луговая, д. 2	16116	Жилой дом в , по адресу с. Филимоново, ул. Луговая, д. 2, 1971 года постройки, под управлением УК «Фжк».
358459	55.503119999999996	37.589114	2008	202034	420	Москва	Москва	ул. Маршала Савицкого, д. 18, к. 2	Москва, ул. Маршала Савицкого, д. 18, к. 2	19536	Жилой дом в Москве, по адресу ул. Маршала Савицкого, д. 18, к. 2, 2008 года постройки, под управлением ОАО ДЕЗ района Южное Бутово.
172748	51.670327	39.290146	2005	198476.7	495	Воронежская область	Воронеж	ул. Урывского, д. 9	Воронежская область, г. Воронеж, ул. Урывского, д. 9	9778	Жилой дом в Воронеже, по адресу ул. Урывского, д. 9, 2005 года постройки, под управлением УК «Жкх».
55582	56.839587	53.282736	2006	197757	704	Удмуртская Республика	Ижевск	ул. 40 лет Победы, д. 140	Респ. Удмуртская, г. Ижевск, ул. 40 лет Победы, д. 140	3696	Жилой дом в Ижевске, по адресу ул. 40 лет Победы, д. 140, 2006 года постройки, под управлением УК «УК Наш Дом».
18213	55.728018000000006	52.363759	2010	194618	900	Республика Татарстан	Набережные Челны	ул. Раскольникова, д. 25	Респ. Татарстан, г. Набережные Челны, ул. Раскольникова, д. 25	2038	Жилой дом в Набережных Челнах, по адресу ул. Раскольникова, д. 25, 2010 года постройки, под управлением УК «Строим будущее».
10647	54.900254000000004	52.254596	2008	188873.3	426	Республика Татарстан	Альметьевск	ул. Шевченко, д. 154	Респ. Татарстан, р-н. Альметьевский, г. Альметьевск, ул. Шевченко, д. 154	1260	Жилой дом в Альметьевске, по адресу ул. Шевченко, д. 154, 2008 года постройки, под управлением ТСН «Яшьлек».
301446	56.204519	95.462609	1967	150655	47	Красноярский край	поселок Филимоново	с. Филимоново, ул. Луговая, д. 6	Красноярский край, р-н. Канский, с. Филимоново, ул. Луговая, д. 6	16116	Жилой дом в , по адресу с. Филимоново, ул. Луговая, д. 6, 1967 года постройки, под управлением УК «Фжк».
510872	53.351338	50.213219	2012	150000	450	Самарская область	Самара	п. Управленческий, ш. Красноглинское, д. 1/23	Самарская область, п. Управленческий, ш. Красноглинское, д. 1/23	27324	Жилой дом в Самаре, по адресу п. Управленческий, ш. Красноглинское, д. 1/23, 2012 года постройки, под управлением ТСЖ «Управленческий».
441961	54.99352	73.371922	1940	132003	43	Омская область	Омск	ул. Герцена, д. 17	Омская область, г. Омск, ул. Герцена, д. 17	23224	Жилой дом в Омске, по адресу ул. Герцена, д. 17, 1940 года постройки, под управлением УК «УК Жилищник 1».
301441	56.206377	95.459447	1987	127871	48	Красноярский край	поселок Филимоново	с. Филимоново, ул. Западная, д. 9	Красноярский край, р-н. Канский, с. Филимоново, ул. Западная, д. 9	16116	Жилой дом в , по адресу с. Филимоново, ул. Западная, д. 9, 1987 года постройки, под управлением УК «Фжк».
461518	53.221479	44.991717	2011	122261.1	187	Пензенская область	Пенза	ул. Леонова, д. 20	Пензенская область, г. Пенза, ул. Леонова, д. 20	24286	Жилой дом в Пензе, по адресу ул. Леонова, д. 20, 2011 года постройки, под управлением УК «Перспектива+».
